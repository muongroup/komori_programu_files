PARMA4PHITS can determine the energy and angle of cosmic-rays based on PARMA using Monte Carlo method
Details of the model is described in
T.Sato, Analytical model for estimating terrestrial cosmic-ray fluxes nearly anytime and anywhere in the world; Extension of PARMA/EXPACS, 10(12): e0144679 (2015)
T.Sato, Analytical model for estimating the zenith angle dependence of terrestrial cosmic ray fluxes, PLOS ONE, 11(8): e0160390 (2016)
This program is designed to be implemented in Particle and Heavy Ion Transport code PHITS
as its user defined source generation function.
If you would like to calculate cosmic-ray fluxes or doses at certain conditions, 
it is much easier to use EXPACS.
You can download EXPACS from the webiste below
http://phits.jaea.go.jp/expacs

Table of contents
  Readme-phits.txt: This file
  usrsors.f:        User-defined source generation program for PHITS
  subroutines.f90:  Subroutines of PARMA
  phits.inp:        Sample input file of PHITS
  phits.out:        Sample output file of PHITS
  track_reg.out:    Sample tally output file of PHITS (text)
  track_reg.eps:    Sample tally output file of PHITS (image)
  /input:           Databases used in PARMA

Q1. How to use?
A1. You have to compile usrsors.f and subroutines.f90 together with PHITS,
    which is a general purpose Monte Carlo particle transport simulation code.
    You can find the details of PHITS in the website below
    http://phits.jaea.go.jp/

Q2. How to compile?
A2. At first, you have to replace usrsors.f in 'src' folder of PHITS by that included
    in this package, and copy 'subroutines.f90' into the same folder.
    Then, add 'subroutines.f90' in name list of the source files in 'makefile',
    and compile PHITS by using 'make' command.

Q3. How to run PHITS with this source generation program?
A3. You have to set 's-type=100' in [source] section.
    See 'phits.inp' as an example.
    Note that 'input' folder should be in the folder where your PHITS input file exists.

Q4. What kind of sources are generated by this program?
A4. A spherical area with radius of r0 cm is irradiated by cosmic-ray
    neutrons, protons, He ions, muons, electrons, positrons, or photons
    at a certain condition in the atmosphere.
    The source generation method is similar to 's-type=10' and 'dir=iso',
    but energy and angular distributions of cosmic-rays are considered.
    +Z direction is heaven, while -Z direction is ground.
    
Q5. How to change the condition?
A5. You have to directly change the parameters written in the lines between 86 to 94

Q6. How to normalize the data?
A6. When you run PHITS using this source generation function, a conversion factor
    from (/source) to (/sec) is output in the console.
    If you would like to obtain the tally results in the unit of (/sec) instead
    of (/source), you have to set the value as 'totfact' in [source] section.

Q7. How to change the surrounding conditions, such as ground or aircraft
A7. You have to change "g" parameter.
    If you want to calculate the cosmic-ray spectra in the ideal atmosphere
    (i.e. without considering the surrounding effect), you should set g=10.0
    If you want to calculate the ground level cosmic-ray spectra, you should
    set 0 =< g =< 1. In this case, "g" means the water fraction in ground.
    Ground level muon correction is also considered in this mode.
    If you do not know the water fraction at your specified location, 
    I recommended to use 0.15 for "g".
    If you want to calculate the cosmic-ray spectra in aircraft, you should
    set -10 < g < 0. In this case, the absolute value of "g" indicates
    the mass of the aircraft in the unit of 100 ton. 
    It should be noted that only neutron spectrum is influenced by 
    the surrounding condition.
    If you want to calculate the angular differential cosmic-ray fluxes without
    the albedo from the Earth (i.e. black hole mode), you should set g=100.0.

Q8. What is the conditions to use this program?
A8. For non-commercial use, you should refer the following manuscripts in any published use of this program,
    T.Sato, Analytical model for estimating terrestrial cosmic-ray fluxes nearly anytime and anywhere in the world; Extension of PARMA/EXPACS, 10(12): e0144679 (2015)
    T.Sato, Analytical model for estimating the zenith angle dependence of terrestrial cosmic ray fluxes, PLOS ONE, 11(8): e0160390 (2016)
    The commercial use of this program is NOT allowed with a prior agreement with JAEA

Contact
  If you have any questions or requests on this program, 
  please E-mail to nsed-expacs@jaea.go.jp
